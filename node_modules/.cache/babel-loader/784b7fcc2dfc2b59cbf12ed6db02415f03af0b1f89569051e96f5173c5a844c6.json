{"ast":null,"code":"import * as React from 'react';\nimport { useRef, useEffect } from 'react';\nimport * as THREE from 'three';\nimport { useThree } from '@react-three/fiber';\nimport { suspend } from 'suspend-react';\nvar _window$document, _window$navigator;\nconst IS_BROWSER = typeof window !== 'undefined' && typeof ((_window$document = window.document) == null ? void 0 : _window$document.createElement) === 'function' && typeof ((_window$navigator = window.navigator) == null ? void 0 : _window$navigator.userAgent) === 'string';\nlet _HLSModule = null;\nasync function getHLS(url, config) {\n  if (IS_BROWSER && url.pathname.endsWith('.m3u8')) {\n    var _HLSModule2;\n    (_HLSModule2 = _HLSModule) !== null && _HLSModule2 !== void 0 ? _HLSModule2 : _HLSModule = await import('hls.js');\n    if (_HLSModule.default.isSupported()) {\n      return new _HLSModule.default({\n        ...config\n      });\n    }\n  }\n  return null;\n}\nfunction useVideoTexture(src) {\n  let {\n    unsuspend = 'loadedmetadata',\n    start = true,\n    crossOrigin = 'anonymous',\n    muted = true,\n    loop = true,\n    hls = {},\n    ...videoProps\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const url = new URL(typeof src === 'string' ? src : '', window.location.href);\n  const hlsRef = useRef(null);\n  const videoRef = useRef(null);\n  const gl = useThree(state => state.gl);\n  const texture = suspend(() => new Promise(async res => {\n    const video = Object.assign(document.createElement('video'), {\n      src: typeof src === 'string' && src || undefined,\n      srcObject: src instanceof MediaStream && src || undefined,\n      crossOrigin,\n      loop,\n      muted,\n      ...videoProps\n    });\n    videoRef.current = video;\n\n    // hlsjs extension\n    if (typeof src === 'string') {\n      const _hls = hlsRef.current = await getHLS(url, hls);\n      if (_hls) {\n        _hls.attachMedia(video);\n        _hls.on('hlsMediaAttached', () => {\n          _hls.loadSource(src);\n        });\n      } else {\n        video.src = src;\n      }\n    } else if (src instanceof MediaStream) {\n      video.srcObject = src;\n    }\n    const texture = new THREE.VideoTexture(video);\n    if ('colorSpace' in texture) texture.colorSpace = gl.outputColorSpace;else texture.encoding = gl.outputEncoding;\n    video.addEventListener(unsuspend, () => res(texture));\n  }), [src]);\n  useEffect(() => {\n    start && texture.image.play();\n    return () => {\n      if (hlsRef.current) {\n        hlsRef.current.destroy();\n        hlsRef.current = null;\n      }\n    };\n  }, [texture, start]);\n  return texture;\n}\n\n//\n\nconst VideoTexture = _ref => {\n  let {\n    children,\n    src,\n    ...config\n  } = _ref;\n  const ret = useVideoTexture(src, config);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, children == null ? void 0 : children(ret));\n};\nexport { VideoTexture, useVideoTexture };","map":{"version":3,"names":["React","useRef","useEffect","THREE","useThree","suspend","_window$document","_window$navigator","IS_BROWSER","window","document","createElement","navigator","userAgent","_HLSModule","getHLS","url","config","pathname","endsWith","_HLSModule2","default","isSupported","useVideoTexture","src","unsuspend","start","crossOrigin","muted","loop","hls","videoProps","arguments","length","undefined","URL","location","href","hlsRef","videoRef","gl","state","texture","Promise","res","video","Object","assign","srcObject","MediaStream","current","_hls","attachMedia","on","loadSource","VideoTexture","colorSpace","outputColorSpace","encoding","outputEncoding","addEventListener","image","play","destroy","_ref","children","ret","Fragment"],"sources":["/Users/timothycharouk/Documents/my-app/node_modules/@react-three/drei/core/VideoTexture.js"],"sourcesContent":["import * as React from 'react';\nimport { useRef, useEffect } from 'react';\nimport * as THREE from 'three';\nimport { useThree } from '@react-three/fiber';\nimport { suspend } from 'suspend-react';\n\nvar _window$document, _window$navigator;\nconst IS_BROWSER = typeof window !== 'undefined' && typeof ((_window$document = window.document) == null ? void 0 : _window$document.createElement) === 'function' && typeof ((_window$navigator = window.navigator) == null ? void 0 : _window$navigator.userAgent) === 'string';\nlet _HLSModule = null;\nasync function getHLS(url, config) {\n  if (IS_BROWSER && url.pathname.endsWith('.m3u8')) {\n    var _HLSModule2;\n    (_HLSModule2 = _HLSModule) !== null && _HLSModule2 !== void 0 ? _HLSModule2 : _HLSModule = await import('hls.js');\n    if (_HLSModule.default.isSupported()) {\n      return new _HLSModule.default({\n        ...config\n      });\n    }\n  }\n  return null;\n}\nfunction useVideoTexture(src, {\n  unsuspend = 'loadedmetadata',\n  start = true,\n  crossOrigin = 'anonymous',\n  muted = true,\n  loop = true,\n  hls = {},\n  ...videoProps\n} = {}) {\n  const url = new URL(typeof src === 'string' ? src : '', window.location.href);\n  const hlsRef = useRef(null);\n  const videoRef = useRef(null);\n  const gl = useThree(state => state.gl);\n  const texture = suspend(() => new Promise(async res => {\n    const video = Object.assign(document.createElement('video'), {\n      src: typeof src === 'string' && src || undefined,\n      srcObject: src instanceof MediaStream && src || undefined,\n      crossOrigin,\n      loop,\n      muted,\n      ...videoProps\n    });\n    videoRef.current = video;\n\n    // hlsjs extension\n    if (typeof src === 'string') {\n      const _hls = hlsRef.current = await getHLS(url, hls);\n      if (_hls) {\n        _hls.attachMedia(video);\n        _hls.on('hlsMediaAttached', () => {\n          _hls.loadSource(src);\n        });\n      } else {\n        video.src = src;\n      }\n    } else if (src instanceof MediaStream) {\n      video.srcObject = src;\n    }\n    const texture = new THREE.VideoTexture(video);\n    if ('colorSpace' in texture) texture.colorSpace = gl.outputColorSpace;else texture.encoding = gl.outputEncoding;\n    video.addEventListener(unsuspend, () => res(texture));\n  }), [src]);\n  useEffect(() => {\n    start && texture.image.play();\n    return () => {\n      if (hlsRef.current) {\n        hlsRef.current.destroy();\n        hlsRef.current = null;\n      }\n    };\n  }, [texture, start]);\n  return texture;\n}\n\n//\n\nconst VideoTexture = ({\n  children,\n  src,\n  ...config\n}) => {\n  const ret = useVideoTexture(src, config);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, children == null ? void 0 : children(ret));\n};\n\nexport { VideoTexture, useVideoTexture };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}